<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Store</title>
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>
<script>
    // **CRITICAL FIX:** API URL Stability
    const API_URL = 'https://couple-voice-chat-app.onrender.com'; 
    const socket = io({ transports: ['websocket', 'polling'] }); 

    // --- Store Logic ---
    async function loadStoreItems() {
        try {
            // FIX: Using API_URL for correct API access
            const response = await fetch(`${API_URL}/api/store/items`); 
            const data = await response.json();

            if (data.success) {
                renderStoreItems(data.items);
            } else {
                console.error("Failed to load store items:", data.message);
            }
        } catch (error) {
            console.error("Store API Error:", error);
            // Handle error, maybe show placeholder items
        }
    }

    function renderStoreItems(items) {
        const userCarContainer = document.getElementById('userCarContainer');
        userCarContainer.innerHTML = '';
        
        items.filter(item => item.type !== 'pair_car').forEach(item => {
            // FIX: Using correct path for images
            const imageUrl = `${API_URL}${item.img}`; 
            
            // ... (HTML rendering logic for store items here) ...
        });
    }

    // Load store items when the page starts
    loadStoreItems();
</script>

</body>
</html>
